## 安全求交PSI
### 编译
> 生成可执行文件  
>>+ bash build.sh

> 命令行参数意义  
>> Experimenet flag:
>>+ -r 0    to run a sender.[表示发送端]  
>>+ -r 1    to run a receiver.[表示接收端]  

>> Parameters:
>>+ -ss     the size of dataset on sender side.[发送端数据个数]  
>>+ -rs     the size of dataset on receiver side.[接收端数据个数]  
>>+ -ids    the size of an ID for bytes.[ID字节长度，默认18]  
>>+ -w      width of the matrix.[矩阵宽度,默认60]  
>>+ -h      log(height) of the matrix.[矩阵高度的对数值,默认10]  
>>+ -sd     common seed (optional) for sender and receiver.[双方的公共种子，含有默认值]  
>>+ -in     the input file path.[输入数据文件路径]  
>>+ -out    the output file path saving psi-set.[保存交集数据的文件路径]  
>>+ -ip     ip address.[ip地址]  
>>+ -port   port.[端口]  
### 运行
> 发送端：
>+ ./psi -r 0 -w 60 -h 10 -ss 5000000 -rs 5000000 -sd 22 -in ../../../500w_1.txt  

> 接收端：
>+ ./psi -r 1 -w 60 -h 10 -ss 5000000 -rs 5000000 -sd 22 -in ../../../500w_2.txt -out ../../../500w_2_save.txt
### 测试
> 机器环境：i5-6200U,16G-ddr3  

> 双方都是5百万数据  
>> h=10,height=1024  
>>+ 表1  

>> | w | h  | ss(百万) | rs(百万) | time(s) |  
>> | :---: | :---: | :---: | :---: | :---: |  
>> | 60  | 10 | 5 | 5 | 14 |  
>> | 80  | 10 | 5 | 5 | 15.7 |
>> | 100 | 10 | 5 | 5 | 18 |
>> | 200 | 10 | 5 | 5 | 28 |
>> | 300 | 10 | 5 | 5 | 41 |
>> | 400 | 10 | 5 | 5 | 49 |
>> | 500 | 10 | 5 | 5 | 61 |  

>> 结论：随着矩阵宽度w的增加，安全求交耗时t也随之增加；如图：  

>> ![ images ](https://github.com/Zhenhanyijiu/tool/blob/main/oprf/psi_bin/500w.jpg)

>> h=20,height=2^20
>>+ 表2

>> | w | h  | ss(百万) | rs(百万) | time(s) |  
>> | :---: | :---: | :---: | :---: | :---: |  
>> | 100 | 20 | 5 | 5 | 18 |
>> | 200 | 20 | 5 | 5 | 30 |
>> | 300 | 20 | 5 | 5 | 41 |
>> | 400 | 20 | 5 | 5 | 53 |
>> | 500 | 20 | 5 | 5 | 64 |  

>> 结论：与表1相比，矩阵宽度w相同，增加矩阵高度h,对性能几乎没有影响；

> 固定矩阵宽度高度：w=60,h=10；双方数据量相同
>> | w | h  | ss(千万) | rs(千万) | time(s) |  
>> | :---: | :---: | :---: | :---: | :---: |  
>> | 60 | 10 | 1 | 1 | 29 |
>> | 60 | 10 | 2 | 2 | 60 |
>> | 60 | 10 | 3 | 3 | 97 |
>> | 60 | 10 | 5 | 5 | 165 |  

>> 结论：固定矩阵宽度w和高度h,耗时随着数据量的增加而线性增加；

> 双方数据量不对称，固定w=60,h=10
>> | w | h  | ss(万) | rs(万) | time(s) |  
>> | :---: | :---: | :---: | :---: | :---: |  
>> | 100 | 10 | 5 | 500 | 7, 14 |
>> | 100 | 10 | 500 | 5 | 9.6, 9.6 |
>> | 200 | 10 | 5 | 500 | 12, 21 |
>> | 200 | 10 | 500 | 5 | 14.8, 14.8 | 

>> 结论：双方数据不对称，耗时主要受到接收方数据量大小的影响；